<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#f4a63a" />
  <title>爬山熊・百岳</title>

  <!-- 正確路徑：icons/ ✅ -->
  <link rel="icon" type="image/png" sizes="192x192" href="icons/hiking_bear_icon_192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="icons/hiking_bear_icon_512.png" />
  <link rel="apple-touch-icon" href="icons/hiking_bear_icon_1024.png" />

  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <div class="app">
    <!-- Topbar -->
    <header class="topbar">
      <div class="brand">
        <button class="avatar" id="bearBtn" title="點我換一句小語（長按可複製）" aria-label="點我換一句小語（長按可複製）">
          <img src="icons/hiking_bear_icon_1024.png" alt="爬山熊" />
        </button>
        <div class="title">
          <h1>爬山熊・百岳</h1>
          <div class="sub" id="subTitle">抽山・集卡・日記本</div>
        </div>
      </div>

      <div class="top-right">
        <div class="pill" id="statusPill">⛰️ 載入中…</div>
        <div class="pill" id="progressPill">✅ 0 / 100</div>
      </div>
    </header>

    <!-- Progress bar -->
    <section class="progress-card">
      <div class="progress-row">
        <div class="progress-title">
          <b>登山進度</b>
          <span id="progressText">0 / 100</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width:0%"></div>
        </div>
        <div class="progress-hint" id="milestoneHint">每征服 10 座會解鎖祝賀卡 🎉</div>
      </div>
    </section>

    <!-- Bubble -->
    <section class="bubble" id="bubble">
      🐻 熊熊說：點一下我的頭像，我會跟你說一句出發小語～
      <div class="hint">提示：長按可複製小語</div>
    </section>

    <!-- Pages -->
    <main class="pages">

      <!-- Page: 抽卡 -->
      <section class="page active" id="page-draw">
        <div class="card">
          <div class="card-head">
            <h2>今天想挑戰哪種路線？</h2>
            <div class="toggles">
              <label class="toggle">
                <input type="checkbox" id="toggleCardMode" checked />
                <span>集卡模式（征服後不再抽）</span>
              </label>
            </div>
          </div>

          <div class="btns">
            <button class="btn beginner" id="btnBeginner">
              <div class="left">
                <div class="ico">🎒</div>
                <div class="txt">
                  <b>新手百岳</b>
                  <small>親民路線，慢慢走也很棒</small>
                </div>
              </div>
              <div class="arrow">›</div>
            </button>

            <button class="btn intermediate" id="btnIntermediate">
              <div class="left">
                <div class="ico">🥾</div>
                <div class="txt">
                  <b>進階挑戰</b>
                  <small>體能與準備更重要</small>
                </div>
              </div>
              <div class="arrow">›</div>
            </button>

            <button class="btn advanced" id="btnAdvanced">
              <div class="left">
                <div class="ico">⚠️</div>
                <div class="txt">
                  <b>熊熊提醒：需帶隊</b>
                  <small>曝險/迷途風險較高</small>
                </div>
              </div>
              <div class="arrow">›</div>
            </button>
          </div>

          <div class="mini-actions">
            <button class="mini" id="btnHistory">📜 抽卡紀錄</button>
            <button class="mini" id="btnExportHistory">📸 匯出抽卡 IG 圖</button>
          </div>
        </div>
      </section>

      <!-- Page: 百岳資料 -->
      <section class="page" id="page-mountains">
        <div class="card">
          <div class="card-head">
            <h2>百岳資料</h2>
            <div class="subline">可搜尋、可勾選「已征服」</div>
          </div>

          <div class="search-row">
            <input class="input" id="searchInput" placeholder="搜尋山名（例如：玉山 / 雪山 / 合歡）" />
            <select class="select" id="diffFilter">
              <option value="all">全部難度</option>
              <option value="beginner">新手</option>
              <option value="intermediate">進階</option>
              <option value="advanced">需帶隊</option>
            </select>
          </div>

          <div class="list" id="mountainList"></div>
        </div>
      </section>

      <!-- Page: 山旅日記 -->
      <section class="page" id="page-journal">
        <div class="card">
          <div class="card-head">
            <h2>山旅日記本</h2>
            <div class="subline">選日期、選山、上傳照片、寫一段話</div>
          </div>

          <div class="form">
            <label class="field">
              <span>日期</span>
              <input class="input" type="date" id="journalDate" />
            </label>

            <label class="field">
              <span>山名</span>
              <select class="select" id="journalMountain"></select>
            </label>

            <label class="field">
              <span>照片</span>
              <input class="input" type="file" id="journalPhoto" accept="image/*" />
              <small class="small">提示：照片會存在本機（localStorage），不會上傳到網路。</small>
              <div class="photo-preview" id="photoPreview" hidden></div>
            </label>

            <label class="field">
              <span>留一段話</span>
              <textarea class="textarea" id="journalText" rows="4" placeholder="今天的天氣、心情、路線、你想記下的一句話…"></textarea>
            </label>

            <div class="row">
              <button class="btn solid" id="saveJournal">💾 儲存日記</button>
              <button class="btn" id="resetJournal">清空</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="card-head">
            <h2>我的登山紀錄</h2>
            <div class="subline">可依日期/山名查詢</div>
          </div>

          <div class="search-row">
            <input class="input" id="journalQuery" placeholder="搜尋（日期或山名）" />
            <button class="mini" id="exportJournalIG">📸 匯出最新日記 IG 圖</button>
          </div>

          <div class="list" id="journalList"></div>
        </div>
      </section>

      <!-- Page: 設定 -->
      <section class="page" id="page-settings">
        <div class="card">
          <div class="card-head">
            <h2>設定</h2>
            <div class="subline">清除資料、重置集卡</div>
          </div>

          <div class="settings">
            <button class="btn danger" id="btnResetVisited">重置「已征服」</button>
            <button class="btn danger" id="btnResetHistory">清除抽卡紀錄</button>
            <button class="btn danger" id="btnResetJournal">清除日記本</button>
            <button class="btn danger" id="btnResetAll">全部清除（重置 App）</button>
          </div>

          <div class="footer-note">
            📷 爬山熊 IG：
            <a href="https://www.instagram.com/luckygbear" target="_blank" rel="noopener">@luckygbear</a>
            <br/>
            🧡 安全第一：天氣不好就改期；能平安回家才是最棒的冒險。
          </div>
        </div>
      </section>

    </main>

    <!-- Bottom Tab -->
    <nav class="tabbar">
      <button class="tab active" data-tab="draw">
        <span class="t-ico">🎴</span><span class="t-txt">抽山</span>
      </button>
      <button class="tab" data-tab="mountains">
        <span class="t-ico">⛰️</span><span class="t-txt">百岳</span>
      </button>
      <button class="tab" data-tab="journal">
        <span class="t-ico">📔</span><span class="t-txt">日記</span>
      </button>
      <button class="tab" data-tab="settings">
        <span class="t-ico">⚙️</span><span class="t-txt">設定</span>
      </button>
    </nav>
  </div>

  <!-- Modal: 抽到的山 -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
    <div class="modal">
      <div class="modal-head">
        <b id="modalHeadTitle">抽到的山</b>
        <button class="close" id="closeModal">關閉</button>
      </div>
      <div class="modal-body">
        <div class="m-card" id="resultCard"></div>
        <div class="safe">
          ⚠️ 安全提醒：高山症、失溫、午後雷雨、濃霧迷途都很常見。請依天候與自身狀況調整或撤退。
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: 祝賀卡 -->
  <div class="modal-backdrop" id="celeBackdrop" aria-hidden="true">
    <div class="modal">
      <div class="modal-head">
        <b id="celeTitle">🎉 特別祝賀卡</b>
        <button class="close" id="closeCele">關閉</button>
      </div>
      <div class="modal-body">
        <div class="m-card" id="celeBody"></div>
        <div class="row">
          <button class="btn solid" id="exportCeleIG">📸 匯出 IG 祝賀圖</button>
          <button class="btn" id="closeCele2">稍後</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./script.js"></script>
</body>
</html>