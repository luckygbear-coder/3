<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>登山熊｜百岳抽卡 🐻⛰️</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#f4a63a" />

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="apple-touch-icon" href="./icons/apple-touch-icon.png">

  <link rel="stylesheet" href="./style.css">
</head>
<body>

<div class="app">

  <!-- ========== 抽山頁 ========== -->
  <main class="content page" id="pageDraw">

    <header class="header">
      <div class="bear">
        <img src="./images/bear.png" alt="登山熊" />
      </div>
      <div class="header-info">
        <div class="status">⛰️ 今日狀態：<span id="todayStatus">準備出發</span></div>
        <div class="progress-text">✅ <span id="progressCount">0</span> / 100</div>
      </div>
    </header>

    <section class="card">
      <div class="row">
        <h3>登山進度</h3>
        <div class="muted"><span id="progressCount2">0</span> / 100</div>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p class="small">每征服 10 座會解鎖祝賀卡 🎉</p>
    </section>

    <section class="card bear-talk" id="bearTalk">
      🐻 熊熊說：把安全放第一名，你就已經是高手了。
      <div class="hint">提示：長按可複製小語</div>
    </section>

    <section class="card">
      <h3>今天想挑戰哪種路線？</h3>

      <label class="checkbox">
        <input type="checkbox" id="collectMode" checked>
        集卡模式（征服後不再抽）
      </label>

      <div class="route" data-diff="beginner">
        <div class="route-left"><div class="route-icon">🎒</div></div>
        <div class="route-mid">
          <div class="route-title">新手百岳</div>
          <div class="route-sub">親民路線，慢慢走也很棒</div>
        </div>
        <div class="route-right">›</div>
      </div>

      <div class="route" data-diff="intermediate">
        <div class="route-left"><div class="route-icon">🥾</div></div>
        <div class="route-mid">
          <div class="route-title">進階挑戰</div>
          <div class="route-sub">體能與準備更重要</div>
        </div>
        <div class="route-right">›</div>
      </div>

      <div class="route" data-diff="advanced">
        <div class="route-left"><div class="route-icon warn">⚠️</div></div>
        <div class="route-mid">
          <div class="route-title">熊熊提醒：需帶隊</div>
          <div class="route-sub">曝險 / 迷途風險較高</div>
        </div>
        <div class="route-right">›</div>
      </div>
    </section>

    <div class="bottom-spacer"></div>
  </main>

  <!-- ========== 百岳頁 ========== -->
  <main class="content page hidden" id="pageList">

    <header class="header">
      <div class="bear">
        <img src="./images/bear.png" alt="登山熊" />
      </div>
      <div class="header-info">
        <div class="status">⛰️ 百岳清單</div>
        <div class="progress-text">✅ <span id="listDoneCount">0</span> / 100</div>
      </div>
    </header>

    <section class="card">
      <div class="search-row">
        <input id="searchInput" class="search" type="search" placeholder="搜尋山名（中文/英文）或高度，例如：玉山 / Yushan / 3952" />
        <button id="btnClearSearch" class="search-clear">清除</button>
      </div>

      <div class="filter-row">
        <button class="chip active" data-filter="all">全部</button>
        <button class="chip" data-filter="beginner">新手</button>
        <button class="chip" data-filter="intermediate">進階</button>
        <button class="chip" data-filter="advanced">需帶隊</button>
        <button class="chip" data-filter="done">已征服</button>
        <button class="chip" data-filter="todo">未征服</button>
      </div>

      <div class="small">
        ✅ 勾選「已征服」會同步進度（支援搜尋、篩選、滾動）
      </div>
    </section>

    <section class="card list-card">
      <div id="mountainList" class="m-list"></div>
    </section>

    <div class="bottom-spacer"></div>
  </main>

  <!-- ========== 日記頁 ========== -->
  <main class="content page hidden" id="pageJournal">

    <header class="header">
      <div class="bear">
        <img src="./images/bear.png" alt="登山熊" />
      </div>
      <div class="header-info">
        <div class="status">📒 勇者日記</div>
        <div class="progress-text">📝 <span id="journalCount">0</span> 筆</div>
      </div>
    </header>

    <section class="card">
      <h3>新增一筆登山紀錄</h3>

      <div class="j-grid">
        <label class="j-label">
          日期
          <input id="jDate" class="j-input" type="date">
        </label>

        <label class="j-label">
          山名（可直接選）
          <select id="jMountain" class="j-input">
            <option value="">— 選擇百岳（可空白）—</option>
          </select>
        </label>

        <label class="j-label">
          心情
          <select id="jMood" class="j-input">
            <option value="😄 開心">😄 開心</option>
            <option value="🙂 平靜">🙂 平靜</option>
            <option value="😮 驚喜">😮 驚喜</option>
            <option value="🥺 很累但值得">🥺 很累但值得</option>
            <option value="😣 辛苦">😣 辛苦</option>
            <option value="😴 想睡">😴 想睡</option>
          </select>
        </label>

        <label class="j-label j-span2">
          今日心得（可空白）
          <textarea id="jNote" class="j-text" rows="4" placeholder="例如：配速很穩、天氣變化快，記得帶風雨衣。"></textarea>
        </label>
      </div>

      <div class="j-actions">
        <button class="j-btn primary" id="btnAddJournal">＋ 新增紀錄</button>
        <button class="j-btn" id="btnQuickFromCard">用「剛抽到的山」帶入</button>
      </div>

      <div class="small">資料會存在手機/瀏覽器（localStorage）。清除瀏覽器資料會消失。</div>
    </section>

    <section class="card">
      <div class="row">
        <h3>我的日記</h3>
        <button class="j-btn danger" id="btnClearJournal">清空全部</button>
      </div>

      <div id="journalList" class="j-list"></div>
    </section>

    <div class="bottom-spacer"></div>
  </main>

  <!-- 固定 Dock（抽山頁才顯示） -->
  <section class="dock" id="dock">
    <button class="dock-btn" id="btnHistory">📜 抽卡紀錄</button>
    <button class="dock-btn" id="btnExport">📸 匯出 IG 祝賀圖</button>
    <button class="dock-btn primary" id="btnDraw">🎴 立即抽一張</button>
  </section>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <button class="nav-btn active" data-page="draw">抽山</button>
    <button class="nav-btn" data-page="list">百岳</button>
    <button class="nav-btn" data-page="journal">日記</button>
    <button class="nav-btn" data-page="settings">設定</button>
  </nav>

</div>

<!-- 山卡彈窗 Modal（抽山結果用 / 百岳看卡片也共用） -->
<div class="modal hidden" id="modal">
  <div class="modal-mask" id="modalMask"></div>

  <div class="modal-card" role="dialog" aria-modal="true">
    <div class="modal-head">
      <div class="modal-title">🎉 特別祝賀卡</div>
      <button class="modal-close" id="modalClose">關閉</button>
    </div>

    <div class="modal-body">
      <div class="big-title" id="mBigTitle">你太猛了！</div>
      <div class="subline" id="mSubline">已完成 0 / 100</div>

      <div class="divider"></div>

      <div class="mountain-name" id="mName">—</div>
      <div class="mountain-info" id="mInfo">—</div>

      <p class="txt" id="mStory"></p>
      <p class="txt" id="mAdvice"></p>
      <p class="risk" id="mRisk"></p>

      <div class="divider"></div>
      <div class="igline">📷 IG @luckygbear</div>
    </div>

    <div class="modal-actions">
      <button class="primary wide" id="btnConquer">✅ 已征服</button>
      <button class="wide ghost" id="btnLater">稍後</button>
    </div>
  </div>
</div>

<script src="./script.js"></script>
</body>
</html>